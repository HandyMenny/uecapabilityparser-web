import{u as C,G as Q,y as w,_ as E,g as Z,Z as b,n as z,M as d,d as y,Y as u,q as m,A as U,p as K}from"./q-OyUNoDim.js";import{S as H}from"./q-x8gzk8Gq.js";import{a as R,E as $}from"./q-ZppFbWGL.js";import{B as P}from"./q-R2-L3Y_F.js";import{C as Y}from"./q-bMS8yB9f.js";import{M as J}from"./q-uPXet747.js";import{T as W}from"./q-uHTLEijd.js";const X=typeof btoa=="function",L=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const I=typeof TextEncoder=="function"?new TextEncoder:void 0,tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",D=Array.prototype.slice.call(tt);(t=>{let e={};return t.forEach((i,a)=>e[i]=a),e})(D);const x=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const O=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),et=t=>{let e,i,a,r,o="";const n=t.length%3;for(let s=0;s<t.length;){if((i=t.charCodeAt(s++))>255||(a=t.charCodeAt(s++))>255||(r=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");e=i<<16|a<<8|r,o+=D[e>>18&63]+D[e>>12&63]+D[e>>6&63]+D[e&63]}return n?o.slice(0,n-3)+"===".substring(n):o},k=X?t=>btoa(t):L?t=>Buffer.from(t,"binary").toString("base64"):et,S=L?t=>Buffer.from(t).toString("base64"):t=>{let i=[];for(let a=0,r=t.length;a<r;a+=4096)i.push(x.apply(null,t.subarray(a,a+4096)));return k(i.join(""))},V=(t,e=!1)=>e?O(S(t)):S(t),nt=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?x(192|e>>>6)+x(128|e&63):x(224|e>>>12&15)+x(128|e>>>6&63)+x(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return x(240|e>>>18&7)+x(128|e>>>12&63)+x(128|e>>>6&63)+x(128|e&63)}},it=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,st=t=>t.replace(it,nt),q=L?t=>Buffer.from(t,"utf8").toString("base64"):I?t=>S(I.encode(t)):t=>k(st(t)),j=(t,e=!1)=>e?O(q(t)):q(t),at=async t=>{const e=await t.arrayBuffer();return V(new Uint8Array(e))},G=t=>{var a;const i=(a=t.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:a.map(r=>parseInt(r,16));return Uint8Array.from(i??[])},rt=async(t,e)=>t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]?V(G(e)):j(e),ot=(t,e)=>{if(t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]){const a=G(e);return new File([a],"")}else return new File([e],"")},_=async(t,e,i,a)=>{const r=t.get(i),o=await rt(e,r);let n="";const s=t.getAll(a);if(s.length==1)n=await at(s[0]);else if(s.length>1){const l=s.map(f=>f.text()),c=await Promise.all(l);n=j(c.reduce((f,p)=>`${f}

${p}`))}return n.length>0?n:o},N=(t,e,i,a)=>{const r=t.get(i),o=ot(e,r),s=t.getAll(a).filter(l=>l.size>0);return s.length>0?s:o.size>0?[o]:[]},lt=async t=>{const e=new FormData(t),i=e.get("0-type"),a=e.get("0-description"),r=await _(e,i,"0-inputText","0-inputFile");let o=null,n=null;i=="H"&&(o=await _(e,i,"0-inputENDCText","0-inputENDCFile"),n=await _(e,i,"0-inputNRText","0-inputNRFile"));const s={type:i,input:r,inputENDC:o,inputNR:n,multiple0xB826:!0,description:a};return(await R.post($.PARSE,s)).data},ut=async(t,e)=>{const i=new FormData(t),a=[];for(let n=0;n<e;n++){const s=t.get(`${n}-type`),l=t.get(`${n}-description`),c=await _(i,s,`${n}-inputText`,`${n}-inputFile`);if(s=="P"&&c.startsWith("Cg0NC"))throw"PcapNg isn't supported, please convert this file to PCAP before submitting.";let f=[c],p=[];if(s=="H"){const v=await _(i,s,`${n}-inputENDCText`,`${n}-inputENDCFile`),g=await _(i,s,`${n}-inputNRText`,`${n}-inputNRFile`);f=[c,v,g],p=["LTE","ENDC","NR"]}const T={type:s,inputs:f,subTypes:p,description:l};a.push(T)}const o=(await R.post($.PARSEMULTI,a)).data;if(o.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return o},ct=async(t,e)=>{const i=new FormData(t),a=[],r=[];for(let l=0;l<e;l++){const c=i.get(`${l}-type`),f=i.get(`${l}-description`),p=N(i,c,`${l}-inputText`,`${l}-inputFile`);let T=[...p],v=null,g=null;c=="H"&&(v=N(i,c,`${l}-inputENDCText`,`${l}-inputENDCFile`)[0],g=N(i,c,`${l}-inputNRText`,`${l}-inputNRFile`)[0],T=[...p,v,g]);const F=[],B=[];let M=r.length;T.forEach(h=>{h!=null&&(console.log(h),c=="H"&&(h==v?F.push("ENDC"):h==g?F.push("NR"):F.push("LTE")),r.push(h),B.push(M),M++)}),a.push({type:c,inputIndexes:B,subTypes:F,description:f})}const o=$.PARSEMULTIPART,s=(await R.postForm(o,{requests:JSON.stringify(a),file:r})).data;if(s.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return s},pt=async(t,e)=>{const[i,a,r,o,n]=C();r.value=void 0,n.value=!0;try{let s,l,c,f;if(a.value){l="/view/multi/?id=";let p;await H.isMultiPartSupported()?p=await ct(e,i.value):p=await ut(e,i.value),c=p.id,s=p.capabilitiesList??[],f=p.description}else{l="/view/?id=";const p=await lt(e);c=p.id,s=[p]}c!=null&&(history.pushState({},"",l+c),window.addEventListener("popstate",()=>{r.value=void 0,o.value=void 0,n.value=!1},{once:!0})),n.value=!1,r.value=s,o.value=f}catch(s){console.error(s),n.value=!1,alert(s)}},ft=()=>{const[t]=C();t.value>1&&t.value--},dt=async()=>{const[t]=C();t.value=await H.isMultiSupported()},xt=()=>{const[t]=C();t.value++},mt=Q(w(()=>E(()=>import("./q-c4i_b6D5.js"),__vite__mapDeps([])),"s_RxJnt3K50Co")),yt=()=>{Z();const t=b(void 0),e=b(void 0),i=b(!1),a=b(1),r=b(!1),o=w(()=>E(()=>Promise.resolve().then(()=>A),void 0),"s_XNkxOB2umQE",[a,r,t,e,i]);return z(w(()=>E(()=>Promise.resolve().then(()=>A),void 0),"s_Rsa6BhqxF4U",[r]),{strategy:"document-ready"}),d(U,{children:[y("div",null,{class:m((n,s)=>s.value||n.value!==void 0?"hidden":"",[t,i])},[d(W,{addClasses:"mb-4",text:"Parser",[u]:{addClasses:u,text:u}},3,"aW_0"),y("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},y("form",null,{autocomplete:"off",class:"m-auto w-full max-w-2xl",onSubmit$:o,"preventdefault:submit":!0},[[...Array(a.value).keys()].map(n=>d(mt,{prefix:`${n}-`,submitting:i,get multiparse(){return r.value},[u]:{multiparse:m(s=>s.value,[r]),submitting:u}},3,n)),y("div",null,{class:"flex flex-wrap gap-x-4"},[d(P,{label:"Remove",type:"button",get hidden(){return!r.value||a.value<2},onClick$:w(()=>E(()=>Promise.resolve().then(()=>A),void 0),"s_PZjg2AEq0h0",[a]),[u]:{hidden:m((n,s)=>!s.value||n.value<2,[a,r]),label:u,onClick$:u,type:u}},3,"aW_1"),d(P,{label:"Add",type:"button",get hidden(){return!r.value},onClick$:w(()=>E(()=>Promise.resolve().then(()=>A),void 0),"s_iTi9KwAcEYg",[a]),[u]:{hidden:m(n=>!n.value,[r]),label:u,onClick$:u,type:u}},3,"aW_2"),y("div",null,{class:m(n=>n.value>1&&"min-w-full"||"flex-1",[a])},d(P,{label:"Submit",type:"submit",[u]:{label:u,type:u}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),t.value==null&&i.value&&y("div",null,{class:"flex flex-1 flex-col"},d(Y,{centered:!0,[u]:{centered:u}},3,"aW_4"),1,"aW_5"),t.value!==void 0&&!i.value&&d(U,{children:[d(W,{text:"View",[u]:{text:u}},3,"aW_6"),d(J,{get capabilitiesList(){return t.value},get groupDescription(){return e.value},[u]:{capabilitiesList:m(n=>n.value,[t]),groupDescription:m(n=>n.value,[e])}},3,"aW_7")]},1,"aW_8")]},1,"aW_9")},A=Object.freeze(Object.defineProperty({__proto__:null,_hW:K,s_PZjg2AEq0h0:ft,s_Rsa6BhqxF4U:dt,s_XNkxOB2umQE:pt,s_iTi9KwAcEYg:xt,s_wW02utqxH8E:yt},Symbol.toStringTag,{value:"Module"}));export{K as _hW,ft as s_PZjg2AEq0h0,dt as s_Rsa6BhqxF4U,pt as s_XNkxOB2umQE,xt as s_iTi9KwAcEYg,yt as s_wW02utqxH8E};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}