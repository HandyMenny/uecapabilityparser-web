import{f as A,V as tt,g as b,_ as w,l as et,o as _,s as nt,P as m,h as g,K as u,C as h,L as H,v as st}from"./q-OIKTu0zg.js";import{A as it}from"./q-VKuMynVY.js";import{S as L}from"./q-hZKKgc9f.js";import{a as U,E as I}from"./q-ZppFbWGL.js";import{B as R}from"./q-n29VRYS0.js";import{C as rt}from"./q-jXhIXXCl.js";import{M as at}from"./q-IudJFxZh.js";import{T as z}from"./q-Ks1NIY9I.js";const ot=typeof btoa=="function",M=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const O=typeof TextEncoder=="function"?new TextEncoder:void 0,lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",E=Array.prototype.slice.call(lt);(t=>{let e={};return t.forEach((n,i)=>e[n]=i),e})(E);const x=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const V=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),ut=t=>{let e,n,i,a,l="";const s=t.length%3;for(let r=0;r<t.length;){if((n=t.charCodeAt(r++))>255||(i=t.charCodeAt(r++))>255||(a=t.charCodeAt(r++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|a,l+=E[e>>18&63]+E[e>>12&63]+E[e>>6&63]+E[e&63]}return s?l.slice(0,s-3)+"===".substring(s):l},j=ot?t=>btoa(t):M?t=>Buffer.from(t,"binary").toString("base64"):ut,$=M?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let i=0,a=t.length;i<a;i+=4096)n.push(x.apply(null,t.subarray(i,i+4096)));return j(n.join(""))},K=(t,e=!1)=>e?V($(t)):$(t),ct=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?x(192|e>>>6)+x(128|e&63):x(224|e>>>12&15)+x(128|e>>>6&63)+x(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return x(240|e>>>18&7)+x(128|e>>>12&63)+x(128|e>>>6&63)+x(128|e&63)}},pt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ft=t=>t.replace(pt,ct),k=M?t=>Buffer.from(t,"utf8").toString("base64"):O?t=>$(O.encode(t)):t=>j(ft(t)),Q=(t,e=!1)=>e?V(k(t)):k(t),Y="[prepocessor](https://github.com/HandyMenny/uecapabilityparser-prepocessor)",G=`PcapNg isn't supported, please convert this file to PCAP before submitting.<br>You can use ${Y} to do that.`,dt=`Input data too big for this instance.<br> You can use ${Y} to reduce its size.<br>Alternatively, you can run you own instance or use cli.`,mt=async t=>{const e=await t.arrayBuffer();return K(new Uint8Array(e))},J=t=>{var i;const n=(i=t.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:i.map(a=>parseInt(a,16));return Uint8Array.from(n??[])},xt=async(t,e)=>t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]?K(J(e)):Q(e),yt=(t,e)=>{if(t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]){const i=J(e);return new File([i],"")}else return new File([e],"")},v=async(t,e,n,i)=>{const a=t.get(n),l=await xt(e,a);let s="";const r=t.getAll(i);if(r.length==1)s=await mt(r[0]);else if(r.length>1){const c=r.map(p=>p.text()),f=await Promise.all(c);s=Q(f.reduce((p,o)=>`${p}

${o}`))}return s.length>0?s:l},B=(t,e,n,i)=>{const a=t.get(n),l=yt(e,a),r=t.getAll(i).filter(c=>c.size>0);return r.length>0?r:l.size>0?[l]:[]},X=(t,e)=>e?t.startsWith("Cg0NC"):t[0]==10&&t[1]==13&&t[2]==13&&t[3]==10,ht=async t=>{const n=await t.slice(0,4).arrayBuffer();return new Uint8Array(n)},gt=async t=>{const e=new FormData(t),n=e.get("0-type"),i=e.get("0-description"),a=await v(e,n,"0-inputText","0-inputFile");let l=null,s=null;n=="H"&&(l=await v(e,n,"0-inputENDCText","0-inputENDCFile"),s=await v(e,n,"0-inputNRText","0-inputNRFile"));const r={type:n,input:a,inputENDC:l,inputNR:s,multiple0xB826:!0,description:i};return(await U.post(I.PARSE,r)).data},vt=async(t,e)=>{const n=new FormData(t),i=[];for(let s=0;s<e;s++){const r=n.get(`${s}-type`),c=n.get(`${s}-description`),f=await v(n,r,`${s}-inputText`,`${s}-inputFile`);if(r=="P"&&X(f,!0))throw G;let p=[f],o=[];if(r=="H"){const P=await v(n,r,`${s}-inputENDCText`,`${s}-inputENDCFile`),D=await v(n,r,`${s}-inputNRText`,`${s}-inputNRFile`);p=[f,P,D],o=["LTE","ENDC","NR"]}const d={type:r,inputs:p,subTypes:o,description:c};i.push(d)}const l=(await U.post(I.PARSEMULTI,i)).data;if(l.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return l},_t=async(t,e)=>{const n=new FormData(t),i=[],a=[];for(let o=0;o<e;o++){const d=n.get(`${o}-type`),P=n.get(`${o}-description`),D=B(n,d,`${o}-inputText`,`${o}-inputFile`);let C=[...D];if(d=="P"){const y=C[0];if(y!=null){const Z=await ht(y);if(X(Z,!1))throw G}}let S=null,N=null;d=="H"&&(S=B(n,d,`${o}-inputENDCText`,`${o}-inputENDCFile`)[0],N=B(n,d,`${o}-inputNRText`,`${o}-inputNRFile`)[0],C=[...D,S,N]);const T=[],W=[];let q=a.length;C.forEach(y=>{y!=null&&(d=="H"&&(y==S?T.push("ENDC"):y==N?T.push("NR"):T.push("LTE")),a.push(y),W.push(q),q++)}),i.push({type:d,inputIndexes:W,subTypes:T,description:P})}const l=await L.getMaxRequestSize();if(a.map(o=>o.size).reduce((o,d)=>o+d)>=l-1e3)throw dt;const c=I.PARSEMULTIPART,p=(await U.postForm(c,{requests:JSON.stringify(i),file:a})).data;if(p.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return p},bt=async(t,e)=>{const[n,i,a,l,s]=A();a.value=void 0,s.value=!0;try{let r,c,f,p;if(i.value){c="/view/multi/?id=";let o;await L.isMultiPartSupported()?o=await _t(e,n.value):o=await vt(e,n.value),f=o.id,r=o.capabilitiesList??[],p=o.description}else{c="/view/?id=";const o=await gt(e);f=o.id,r=[o]}f!=null&&(history.pushState({},"",c+f),window.addEventListener("popstate",()=>{a.value=void 0,l.value=void 0,s.value=!1},{once:!0})),s.value=!1,a.value=r,l.value=p}catch(r){throw s.value=!1,new it(r)}},wt=()=>{const[t]=A();t.value>1&&t.value--},Et=async()=>{const[t]=A();t.value=await L.isMultiSupported()},Dt=()=>{const[t]=A();t.value++},Tt=tt(b(()=>w(()=>import("./q-7-UgCeLL.js"),__vite__mapDeps([])),"s_RxJnt3K50Co")),Ft=()=>{et();const t=_(void 0),e=_(void 0),n=_(!1),i=_(1),a=_(!1),l=b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_XNkxOB2umQE",[i,a,t,e,n]);return nt(b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_Rsa6BhqxF4U",[a]),{strategy:"document-ready"}),m(H,{children:[g("div",null,{class:h((s,r)=>r.value||s.value!==void 0?"hidden":"",[t,n])},[m(z,{addClasses:"mb-4",text:"Parser",[u]:{addClasses:u,text:u}},3,"aW_0"),g("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},g("form",null,{autocomplete:"off",class:"m-auto w-full max-w-2xl",onSubmit$:l,"preventdefault:submit":!0},[[...Array(i.value).keys()].map(s=>m(Tt,{prefix:`${s}-`,submitting:n,get multiparse(){return a.value},[u]:{multiparse:h(r=>r.value,[a]),submitting:u}},3,s)),g("div",null,{class:"flex flex-wrap gap-x-4"},[m(R,{label:"Remove",type:"button",get hidden(){return!a.value||i.value<2},onClick$:b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_PZjg2AEq0h0",[i]),[u]:{hidden:h((s,r)=>!r.value||s.value<2,[i,a]),label:u,onClick$:u,type:u}},3,"aW_1"),m(R,{label:"Add",type:"button",get hidden(){return!a.value},onClick$:b(()=>w(()=>Promise.resolve().then(()=>F),void 0),"s_iTi9KwAcEYg",[i]),[u]:{hidden:h(s=>!s.value,[a]),label:u,onClick$:u,type:u}},3,"aW_2"),g("div",null,{class:h(s=>s.value>1&&"min-w-full"||"flex-1",[i])},m(R,{label:"Submit",type:"submit",[u]:{label:u,type:u}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),t.value==null&&n.value&&g("div",null,{class:"flex flex-1 flex-col"},m(rt,{centered:!0,[u]:{centered:u}},3,"aW_4"),1,"aW_5"),t.value!==void 0&&!n.value&&m(H,{children:[m(z,{text:"View",[u]:{text:u}},3,"aW_6"),m(at,{get capabilitiesList(){return t.value},get groupDescription(){return e.value},[u]:{capabilitiesList:h(s=>s.value,[t]),groupDescription:h(s=>s.value,[e])}},3,"aW_7")]},1,"aW_8")]},1,"aW_9")},F=Object.freeze(Object.defineProperty({__proto__:null,_hW:st,s_PZjg2AEq0h0:wt,s_Rsa6BhqxF4U:Et,s_XNkxOB2umQE:bt,s_iTi9KwAcEYg:Dt,s_wW02utqxH8E:Ft},Symbol.toStringTag,{value:"Module"}));export{st as _hW,wt as s_PZjg2AEq0h0,Et as s_Rsa6BhqxF4U,bt as s_XNkxOB2umQE,Dt as s_iTi9KwAcEYg,Ft as s_wW02utqxH8E};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}