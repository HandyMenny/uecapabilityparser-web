import{a as k,E}from"./q-Vw2Ei1e8.js";var N=Symbol("cache-parser");function p(e){return(typeof e=="string"||typeof e=="number")&&(e=Number(e))>=0&&e<1/0}function g(e){return e===!0||typeof e=="number"||typeof e=="string"&&e!=="false"}var S=Number;function M(e){var t=Object.defineProperty({},N,{enumerable:!1,value:1});if(!e||typeof e!="string")return t;var a=function(d){var l={},w=d.toLowerCase().replace(/\s+/g,"").split(",");for(var u in w){var y,f=w[u].split("=",2);l[f[0]]=(y=f[1])==null||y}return l}(e),i=a["max-age"],r=a["max-stale"],n=a["min-fresh"],c=a["s-maxage"],s=a["stale-if-error"],o=a["stale-while-revalidate"];return g(a.immutable)&&(t.immutable=!0),p(i)&&(t.maxAge=S(i)),p(r)&&(t.maxStale=S(r)),p(n)&&(t.minFresh=S(n)),g(a["must-revalidate"])&&(t.mustRevalidate=!0),g(a["must-understand"])&&(t.mustUnderstand=!0),g(a["no-cache"])&&(t.noCache=!0),g(a["no-store"])&&(t.noStore=!0),g(a["no-transform"])&&(t.noTransform=!0),g(a["only-if-cached"])&&(t.onlyIfCached=!0),g(a.private)&&(t.private=!0),g(a["proxy-revalidate"])&&(t.proxyRevalidate=!0),g(a.public)&&(t.public=!0),p(c)&&(t.sMaxAge=S(c)),p(s)&&(t.staleIfError=S(s)),p(o)&&(t.staleWhileRevalidate=S(o)),t}var L=Symbol();function X(){var e,t,a=new Promise(function(i,r){e=i,t=r});return a.resolve=e,a.reject=t,a[L]=1,a}function D(e,t){return e>t?1:-1}function b(e,t){var a=5381;if(typeof e=="object"&&e!==null&&(e.toString===Object.prototype.toString||e.toString===Array.prototype.toString)){t||(t=new WeakSet);for(var i=Object.keys(e).sort(D),r=0;r<i.length;r++){var n=i[r],c=e[n];if(a=33*a^b(n,t),typeof c=="object"&&c!==null&&(e.toString===Object.prototype.toString||e.toString===Array.prototype.toString)){if(t.has(c))continue;t.add(c)}a=33*a^b(c,t)}return 33*a^b(e.constructor,t)}var s=typeof e;try{e instanceof Date?s+=e.getTime():s+=String(e)}catch{s+=String(Object.assign({},e))}for(var o=0;o<s.length;o++)a=33*a^s.charCodeAt(o);return a}/*!
 * Axios Cache Interceptor 1.5.1
 * (c) 2021-present Arthur Fiorette & Contributors
 * Released under the MIT License.
 */const h=Object.freeze({IfModifiedSince:"if-modified-since",LastModified:"last-modified",IfNoneMatch:"if-none-match",CacheControl:"cache-control",Pragma:"pragma",ETag:"etag",Expires:"expires",Age:"age",XAxiosCacheEtag:"x-axios-cache-etag",XAxiosCacheLastModified:"x-axios-cache-last-modified",XAxiosCacheStaleIfError:"x-axios-cache-stale-if-error"}),K=e=>{if(!e)return"not enough headers";const t=e[h.CacheControl];if(t){const{noCache:i,noStore:r,maxAge:n,maxStale:c,immutable:s,staleWhileRevalidate:o}=M(String(t));if(i||r)return"dont cache";if(s)return{cache:1e3*60*60*24*365};if(n!==void 0){const d=e[h.Age];return{cache:d?(n-Number(d))*1e3:n*1e3,stale:c!==void 0?c*1e3:o!==void 0?o*1e3:void 0}}}const a=e[h.Expires];if(a){const i=Date.parse(String(a))-Date.now();return i>=0?{cache:i}:"dont cache"}return"not enough headers"};function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},C.apply(this,arguments)}function q(e){return e?t=>e(t)||t===304:t=>t>=200&&t<300||t===304}function T(e="get",t=[]){return e=e.toLowerCase(),t.some(a=>a===e)}function V(e,t){t.headers||(t.headers={});const{etag:a,modifiedSince:i}=t.cache;if(a){var r;const n=a===!0?(r=e.data)==null?void 0:r.headers[h.ETag]:a;n&&(t.headers[h.IfNoneMatch]=n)}i&&(t.headers[h.IfModifiedSince]=i===!0?e.data.headers[h.LastModified]||new Date(e.createdAt).toUTCString():i.toUTCString())}function F(e,t){return e.status===304&&t?(e.cached=!0,e.data=t.data,e.status=t.status,e.statusText=t.statusText,e.headers=C({},t.headers,e.headers),t):{data:e.data,status:e.status,statusText:e.statusText,headers:e.headers}}function G(e){const t=async a=>{if(a.id=e.generateKey(a),a.cache===!1)return a;if(a.cache=C({},e.defaults.cache,a.cache),typeof a.cache.cachePredicate=="object"&&a.cache.cachePredicate.ignoreUrls&&a.url){for(const m of a.cache.cachePredicate.ignoreUrls)if(m instanceof RegExp?(m.lastIndex=0,m.test(a.url)):a.url.includes(m))return a}if(a.cache.cacheTakeover){var i,r,n,c,s,o,d,l,w;(n=(i=a.headers)[r=h.CacheControl])!=null||(i[r]="no-cache"),(o=(c=a.headers)[s=h.Pragma])!=null||(c[s]="no-cache"),(w=(d=a.headers)[l=h.Expires])!=null||(d[l]="0")}if(!T(a.method,a.cache.methods))return a;let u=await e.storage.get(a.id,a);const y=a.cache.override;t:if(u.state==="empty"||u.state==="stale"||y){if(e.waiting[a.id]&&!y&&(u=await e.storage.get(a.id,a),u.state!=="empty"))break t;return e.waiting[a.id]=X(),e.waiting[a.id].catch(()=>{}),await e.storage.set(a.id,{state:"loading",previous:y?u.data?"stale":"empty":u.state,data:u.data,createdAt:y&&!u.createdAt?Date.now():u.createdAt},a),u.state==="stale"&&V(u,a),a.validateStatus=q(a.validateStatus),(u.state==="stale"||u.data)&&await(a.cache.hydrate==null?void 0:a.cache.hydrate(u)),a}let f;if(u.state==="loading"){const m=e.waiting[a.id];if(!m)return u.data&&await(a.cache.hydrate==null?void 0:a.cache.hydrate(u)),a;try{f=await m}catch{return u.data&&await(a.cache.hydrate==null?void 0:a.cache.hydrate(u)),t(a)}}else f=u.data;return a.transformResponse=void 0,a.adapter=function(){return Promise.resolve({config:a,data:f.data,headers:f.headers,status:f.status,statusText:f.statusText,cached:!0,id:a.id})},a};return{onFulfilled:t,apply:()=>e.interceptors.request.use(t)}}async function J(e,t){if(typeof t=="function")return t(e);const{statusCheck:a,responseMatch:i,containsHeaders:r}=t;if(a&&!await a(e.status)||i&&!await i(e))return!1;if(r)for(const[c,s]of Object.entries(r)){var n;if(!await s((n=e.headers[c.toLowerCase()])!=null?n:e.headers[c]))return!1}return!0}async function W(e,t,a){if(typeof a=="function")return a(t);for(const[i,r]of Object.entries(a)){if(r==="delete"){await e.remove(i,t.config);continue}const n=await e.get(i,t.config);if(n.state==="loading")continue;const c=await r(n,t);if(c==="delete"){await e.remove(i,t.config);continue}c!=="ignore"&&await e.set(i,c,t.config)}}function z(e){const t=async(r,n)=>{var c;await e.storage.remove(r,n),(c=e.waiting[r])==null||c.reject(),delete e.waiting[r]},a=async r=>{var n;if(!(r!=null&&r.config))throw r;r.id=r.config.id,(n=r.cached)!=null||(r.cached=!1);const c=r.config,s=c.cache;if(r.cached)return r;if(!s)return r.cached=!1,r;if(s.update&&await W(e.storage,r,s.update),!T(c.method,s.methods))return r;const o=await e.storage.get(r.id,c);if(o.state!=="loading")return r;if(!o.data&&!await J(r,s.cachePredicate))return await t(r.id,c),r;for(const f of Object.keys(r.headers))f.startsWith("x-axios-cache")&&delete r.headers[f];s.etag&&s.etag!==!0&&(r.headers[h.XAxiosCacheEtag]=s.etag),s.modifiedSince&&(r.headers[h.XAxiosCacheLastModified]=s.modifiedSince===!0?"use-cache-timestamp":s.modifiedSince.toUTCString());let d=s.ttl||-1,l;if(s.interpretHeader){const f=e.headerInterpreter(r.headers);if(f==="dont cache")return await t(r.id,c),r;f!=="not enough headers"&&(typeof f=="number"?d=f:(d=f.cache,l=f.stale))}const w=F(r,o.data);typeof d=="function"&&(d=await d(r)),s.staleIfError&&(r.headers[h.XAxiosCacheStaleIfError]=String(d));const u={state:"cached",ttl:d,staleTtl:l,createdAt:Date.now(),data:w},y=e.waiting[r.id];return y&&(y.resolve(u.data),delete e.waiting[r.id]),await e.storage.set(r.id,u,c),r},i=async r=>{if(!r.isAxiosError||!r.config)throw r;const n=r.config,c=n.id,s=n.cache,o=r.response;if(!s||!c)throw r;if(!T(n.method,s.methods))throw await t(c,n),r;const d=await e.storage.get(c,n);if(d.state!=="loading"||d.previous!=="stale")throw await t(c,n),r;if(s.staleIfError){const w=String(o==null?void 0:o.headers[h.CacheControl]),u=w&&M(w).staleIfError,y=typeof s.staleIfError=="function"?await s.staleIfError(o,d,r):s.staleIfError===!0&&u?u*1e3:s.staleIfError;if(y===!0||typeof y=="number"&&d.createdAt+y>Date.now()){var l;return(l=e.waiting[c])==null||l.resolve(d.data),delete e.waiting[c],await e.storage.set(c,{state:"stale",createdAt:Date.now(),data:d.data},n),{cached:!0,config:n,id:c,data:d.data.data,headers:d.data.headers,status:d.data.status,statusText:d.data.statusText}}}throw await t(c,n),r};return{onFulfilled:a,onRejected:i,apply:()=>e.interceptors.response.use(a,i)}}const U=e=>!!e&&!!e["is-storage"];function P(e){const t=e.data.headers;return h.ETag in t||h.LastModified in t||h.XAxiosCacheEtag in t||h.XAxiosCacheLastModified in t}function R(e){return String(e.data.headers[h.CacheControl]).includes("must-revalidate")?!1:P(e)?!0:e.state==="cached"&&e.staleTtl!==void 0&&Math.abs(Date.now()-(e.createdAt+e.ttl))<=e.staleTtl}function x(e){return e.ttl!==void 0&&e.createdAt+e.ttl<=Date.now()}function $({set:e,find:t,remove:a}){return{"is-storage":1,set:e,remove:a,get:async(i,r)=>{let n=await t(i,r);if(!n)return{state:"empty"};if(n.state==="empty"||n.state==="loading")return n;if(n.state==="cached"){if(!x(n))return n;if(!R(n))return await a(i,r),{state:"empty"};n={state:"stale",createdAt:n.createdAt,data:n.data,ttl:n.staleTtl!==void 0?n.staleTtl+n.ttl:void 0},await e(i,n,r)}return!x(n)||P(n)?n:(await a(i,r),{state:"empty"})}}}function H(e=!1,t=!1,a=!1){const i=$({set:(r,n)=>{if(a){let c=Object.keys(i.data);if(c.length>=a)for(i.cleanup(),c=Object.keys(i.data);c.length>=a;)delete i.data[c.shift()]}i.data[r]=e==="double"?typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n)):n},remove:r=>{delete i.data[r]},find:r=>{const n=i.data[r];return e&&n!==void 0?typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n)):n}});return i.data=Object.create(null),i.cleanup=()=>{const r=Object.keys(i.data);let n=-1,c,s;for(;++n<r.length;){if(s=r[n],c=i.data[s],c.state==="empty"){i.remove(s);continue}c.state==="cached"&&x(c)&&!R(c)&&i.remove(s)}},t&&(i.cleaner=setInterval(i.cleanup,t)),i}const O=/^\/|\/$/g;function B(e){return t=>{if(t.id)return t.id;const a=e(t);return typeof a=="string"||typeof a=="number"?`${a}`:`${b(a)}`}}const Q=B(({baseURL:e,url:t,method:a,params:i,data:r})=>(e!==void 0?e=e.replace(O,""):e="",t!==void 0?t=t.replace(O,""):t="",a!==void 0?a=a.toLowerCase():a="get",{url:e+(e&&t?"/":"")+t,params:i,method:a,data:r}));function Y(e,t={}){var a,i,r,n,c,s,o,d;const l=e;if(l.defaults.cache)throw new Error("setupCache() should be called only once");if(l.storage=t.storage||H(),!U(l.storage))throw new Error("Use buildStorage() function");return l.waiting=t.waiting||{},l.generateKey=t.generateKey||Q,l.headerInterpreter=t.headerInterpreter||K,l.requestInterceptor=t.requestInterceptor||G(l),l.responseInterceptor=t.responseInterceptor||z(l),l.debug=t.debug||function(){},l.defaults.cache={update:t.update||{},ttl:(a=t.ttl)!=null?a:1e3*60*5,methods:t.methods||["get","head"],cachePredicate:t.cachePredicate||{statusCheck:w=>[200,203,300,301,302,404,405,410,414,501].includes(w)},etag:(i=t.etag)!=null?i:!0,modifiedSince:(r=t.modifiedSince)!=null?r:t.etag===!1,interpretHeader:(n=t.interpretHeader)!=null?n:!0,cacheTakeover:(c=t.cacheTakeover)!=null?c:!0,staleIfError:(s=t.staleIfError)!=null?s:!0,override:(o=t.override)!=null?o:!1,hydrate:(d=t.hydrate)!=null?d:void 0},l.requestInterceptor.apply(),l.responseInterceptor.apply(),l}const Z=k.create(),I=Y(Z),A={cache:{ttl:"1000 * 60",interpretHeader:!1,staleIfError:!1}},v=async()=>{const e=E.STATUS;try{const t=await I.get(e,{...A,validateStatus:()=>!0});if(t.status==200)return t.data}catch(t){console.error(t)}},_=async()=>{const e=E.VERSION;try{return(await I.get(e,A)).data.version}catch(t){console.error(t)}},tt=async()=>{const e=E.STORE+"status";try{return(await I.get(e,A)).data.enabled==!0}catch(t){console.error(t)}return!1},et=async()=>{const e=E.PARSEMULTI;try{const t=await I.get(e,{...A,validateStatus:()=>!0});return t.status!==404&&t.status<500}catch{return!1}};let j;(function(e){e.getVersion=async()=>{const t=await v();return t!=null?t.version:await _()},e.isStoreSuported=async()=>{const t=await v();return t!=null?t.endpoints.includes("/store/list"):await tt()},e.isMultiSupported=async()=>{const t=await v();return t!=null?t.endpoints.includes("/parse/multi")||t.endpoints.includes("/parse/multiPart"):await et()},e.isMultiPartSupported=async()=>{const t=await v();return t!=null?t.endpoints.includes("/parse/multiPart"):!1},e.getMaxRequestSize=async()=>{const t=await v();return t!=null?t.maxRequestSize:Number.MAX_SAFE_INTEGER},e.getSupportedLogs=async()=>{const t=await v();return t!=null?t.logTypes:[]}})(j||(j={}));export{j as S};
