import{u as P,G as z,y as E,_ as D,g as K,Z as w,n as Y,M as d,d as h,Y as u,q as y,A as M,p as J}from"./q-OyUNoDim.js";import{S as H}from"./q-x8gzk8Gq.js";import{a as B,E as R}from"./q-ZppFbWGL.js";import{B as C}from"./q-R2-L3Y_F.js";import{C as X}from"./q-bMS8yB9f.js";import{M as tt}from"./q-uPXet747.js";import{T as I}from"./q-uHTLEijd.js";const et=typeof btoa=="function",$=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const W=typeof TextEncoder=="function"?new TextEncoder:void 0,nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=Array.prototype.slice.call(nt);(t=>{let e={};return t.forEach((n,r)=>e[n]=r),e})(T);const x=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const O=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),st=t=>{let e,n,r,a,o="";const s=t.length%3;for(let i=0;i<t.length;){if((n=t.charCodeAt(i++))>255||(r=t.charCodeAt(i++))>255||(a=t.charCodeAt(i++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|a,o+=T[e>>18&63]+T[e>>12&63]+T[e>>6&63]+T[e&63]}return s?o.slice(0,s-3)+"===".substring(s):o},k=et?t=>btoa(t):$?t=>Buffer.from(t,"binary").toString("base64"):st,S=$?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let r=0,a=t.length;r<a;r+=4096)n.push(x.apply(null,t.subarray(r,r+4096)));return k(n.join(""))},V=(t,e=!1)=>e?O(S(t)):S(t),it=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?x(192|e>>>6)+x(128|e&63):x(224|e>>>12&15)+x(128|e>>>6&63)+x(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return x(240|e>>>18&7)+x(128|e>>>12&63)+x(128|e>>>6&63)+x(128|e&63)}},rt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,at=t=>t.replace(rt,it),q=$?t=>Buffer.from(t,"utf8").toString("base64"):W?t=>S(W.encode(t)):t=>k(at(t)),j=(t,e=!1)=>e?O(q(t)):q(t),ot=async t=>{const e=await t.arrayBuffer();return V(new Uint8Array(e))},G=t=>{var r;const n=(r=t.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:r.map(a=>parseInt(a,16));return Uint8Array.from(n??[])},lt=async(t,e)=>t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]?V(G(e)):j(e),ut=(t,e)=>{if(t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]){const r=G(e);return new File([r],"")}else return new File([e],"")},v=async(t,e,n,r)=>{const a=t.get(n),o=await lt(e,a);let s="";const i=t.getAll(r);if(i.length==1)s=await ot(i[0]);else if(i.length>1){const l=i.map(f=>f.text()),c=await Promise.all(l);s=j(c.reduce((f,p)=>`${f}

${p}`))}return s.length>0?s:o},N=(t,e,n,r)=>{const a=t.get(n),o=ut(e,a),i=t.getAll(r).filter(l=>l.size>0);return i.length>0?i:o.size>0?[o]:[]},Q=(t,e)=>e?t.startsWith("Cg0NC"):t[0]==10&&t[1]==13&&t[2]==13&&t[3]==10,ct=async t=>{const n=await t.slice(0,4).arrayBuffer();return new Uint8Array(n)},pt=async t=>{const e=new FormData(t),n=e.get("0-type"),r=e.get("0-description"),a=await v(e,n,"0-inputText","0-inputFile");let o=null,s=null;n=="H"&&(o=await v(e,n,"0-inputENDCText","0-inputENDCFile"),s=await v(e,n,"0-inputNRText","0-inputNRFile"));const i={type:n,input:a,inputENDC:o,inputNR:s,multiple0xB826:!0,description:r};return(await B.post(R.PARSE,i)).data},ft=async(t,e)=>{const n=new FormData(t),r=[];for(let s=0;s<e;s++){const i=n.get(`${s}-type`),l=n.get(`${s}-description`),c=await v(n,i,`${s}-inputText`,`${s}-inputFile`);if(i=="P"&&Q(c,!0))throw"PcapNg isn't supported, please convert this file to PCAP before submitting.";let f=[c],p=[];if(i=="H"){const g=await v(n,i,`${s}-inputENDCText`,`${s}-inputENDCFile`),b=await v(n,i,`${s}-inputNRText`,`${s}-inputNRFile`);f=[c,g,b],p=["LTE","ENDC","NR"]}const _={type:i,inputs:f,subTypes:p,description:l};r.push(_)}const o=(await B.post(R.PARSEMULTI,r)).data;if(o.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return o},dt=async(t,e)=>{const n=new FormData(t),r=[],a=[];for(let l=0;l<e;l++){const c=n.get(`${l}-type`),f=n.get(`${l}-description`),p=N(n,c,`${l}-inputText`,`${l}-inputFile`);let _=[...p];if(c=="P"){const m=_[0];if(m!=null){const Z=await ct(m);if(Q(Z,!1))throw"PcapNg isn't supported, please convert this file to PCAP before submitting."}}let g=null,b=null;c=="H"&&(g=N(n,c,`${l}-inputENDCText`,`${l}-inputENDCFile`)[0],b=N(n,c,`${l}-inputNRText`,`${l}-inputNRFile`)[0],_=[...p,g,b]);const A=[],L=[];let U=a.length;_.forEach(m=>{m!=null&&(console.log(m),c=="H"&&(m==g?A.push("ENDC"):m==b?A.push("NR"):A.push("LTE")),a.push(m),L.push(U),U++)}),r.push({type:c,inputIndexes:L,subTypes:A,description:f})}const o=R.PARSEMULTIPART,i=(await B.postForm(o,{requests:JSON.stringify(r),file:a})).data;if(i.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return i},xt=async(t,e)=>{const[n,r,a,o,s]=P();a.value=void 0,s.value=!0;try{let i,l,c,f;if(r.value){l="/view/multi/?id=";let p;await H.isMultiPartSupported()?p=await dt(e,n.value):p=await ft(e,n.value),c=p.id,i=p.capabilitiesList??[],f=p.description}else{l="/view/?id=";const p=await pt(e);c=p.id,i=[p]}c!=null&&(history.pushState({},"",l+c),window.addEventListener("popstate",()=>{a.value=void 0,o.value=void 0,s.value=!1},{once:!0})),s.value=!1,a.value=i,o.value=f}catch(i){console.error(i),s.value=!1,alert(i)}},mt=()=>{const[t]=P();t.value>1&&t.value--},yt=async()=>{const[t]=P();t.value=await H.isMultiSupported()},ht=()=>{const[t]=P();t.value++},vt=z(E(()=>D(()=>import("./q-c4i_b6D5.js"),__vite__mapDeps([])),"s_RxJnt3K50Co")),_t=()=>{K();const t=w(void 0),e=w(void 0),n=w(!1),r=w(1),a=w(!1),o=E(()=>D(()=>Promise.resolve().then(()=>F),void 0),"s_XNkxOB2umQE",[r,a,t,e,n]);return Y(E(()=>D(()=>Promise.resolve().then(()=>F),void 0),"s_Rsa6BhqxF4U",[a]),{strategy:"document-ready"}),d(M,{children:[h("div",null,{class:y((s,i)=>i.value||s.value!==void 0?"hidden":"",[t,n])},[d(I,{addClasses:"mb-4",text:"Parser",[u]:{addClasses:u,text:u}},3,"aW_0"),h("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},h("form",null,{autocomplete:"off",class:"m-auto w-full max-w-2xl",onSubmit$:o,"preventdefault:submit":!0},[[...Array(r.value).keys()].map(s=>d(vt,{prefix:`${s}-`,submitting:n,get multiparse(){return a.value},[u]:{multiparse:y(i=>i.value,[a]),submitting:u}},3,s)),h("div",null,{class:"flex flex-wrap gap-x-4"},[d(C,{label:"Remove",type:"button",get hidden(){return!a.value||r.value<2},onClick$:E(()=>D(()=>Promise.resolve().then(()=>F),void 0),"s_PZjg2AEq0h0",[r]),[u]:{hidden:y((s,i)=>!i.value||s.value<2,[r,a]),label:u,onClick$:u,type:u}},3,"aW_1"),d(C,{label:"Add",type:"button",get hidden(){return!a.value},onClick$:E(()=>D(()=>Promise.resolve().then(()=>F),void 0),"s_iTi9KwAcEYg",[r]),[u]:{hidden:y(s=>!s.value,[a]),label:u,onClick$:u,type:u}},3,"aW_2"),h("div",null,{class:y(s=>s.value>1&&"min-w-full"||"flex-1",[r])},d(C,{label:"Submit",type:"submit",[u]:{label:u,type:u}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),t.value==null&&n.value&&h("div",null,{class:"flex flex-1 flex-col"},d(X,{centered:!0,[u]:{centered:u}},3,"aW_4"),1,"aW_5"),t.value!==void 0&&!n.value&&d(M,{children:[d(I,{text:"View",[u]:{text:u}},3,"aW_6"),d(tt,{get capabilitiesList(){return t.value},get groupDescription(){return e.value},[u]:{capabilitiesList:y(s=>s.value,[t]),groupDescription:y(s=>s.value,[e])}},3,"aW_7")]},1,"aW_8")]},1,"aW_9")},F=Object.freeze(Object.defineProperty({__proto__:null,_hW:J,s_PZjg2AEq0h0:mt,s_Rsa6BhqxF4U:yt,s_XNkxOB2umQE:xt,s_iTi9KwAcEYg:ht,s_wW02utqxH8E:_t},Symbol.toStringTag,{value:"Module"}));export{J as _hW,mt as s_PZjg2AEq0h0,yt as s_Rsa6BhqxF4U,xt as s_XNkxOB2umQE,ht as s_iTi9KwAcEYg,_t as s_wW02utqxH8E};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}