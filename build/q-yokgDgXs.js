import{f as P,V as G,g as E,_ as D,l as J,o as w,s as X,P as d,h,K as u,C as y,L as I,v as Z}from"./q-OIKTu0zg.js";import{A as tt}from"./q-VKuMynVY.js";import{S as q}from"./q-x8gzk8Gq.js";import{a as B,E as L}from"./q-ZppFbWGL.js";import{B as C}from"./q-n29VRYS0.js";import{C as et}from"./q-jXhIXXCl.js";import{M as nt}from"./q-IudJFxZh.js";import{T as M}from"./q-Ks1NIY9I.js";const st=typeof btoa=="function",R=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const W=typeof TextEncoder=="function"?new TextEncoder:void 0,it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=Array.prototype.slice.call(it);(t=>{let e={};return t.forEach((n,i)=>e[n]=i),e})(T);const m=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const O=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),rt=t=>{let e,n,i,a,o="";const s=t.length%3;for(let r=0;r<t.length;){if((n=t.charCodeAt(r++))>255||(i=t.charCodeAt(r++))>255||(a=t.charCodeAt(r++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|a,o+=T[e>>18&63]+T[e>>12&63]+T[e>>6&63]+T[e&63]}return s?o.slice(0,s-3)+"===".substring(s):o},k=st?t=>btoa(t):R?t=>Buffer.from(t,"binary").toString("base64"):rt,S=R?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let i=0,a=t.length;i<a;i+=4096)n.push(m.apply(null,t.subarray(i,i+4096)));return k(n.join(""))},V=(t,e=!1)=>e?O(S(t)):S(t),at=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?m(192|e>>>6)+m(128|e&63):m(224|e>>>12&15)+m(128|e>>>6&63)+m(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return m(240|e>>>18&7)+m(128|e>>>12&63)+m(128|e>>>6&63)+m(128|e&63)}},ot=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,lt=t=>t.replace(ot,at),H=R?t=>Buffer.from(t,"utf8").toString("base64"):W?t=>S(W.encode(t)):t=>k(lt(t)),j=(t,e=!1)=>e?O(H(t)):H(t),K="PcapNg isn't supported, please convert this file to PCAP before submitting.<br>You can use [prepocessor](https://github.com/HandyMenny/uecapabilityparser-prepocessor) to do that.",ut=async t=>{const e=await t.arrayBuffer();return V(new Uint8Array(e))},Q=t=>{var i;const n=(i=t.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:i.map(a=>parseInt(a,16));return Uint8Array.from(n??[])},ct=async(t,e)=>t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]?V(Q(e)):j(e),pt=(t,e)=>{if(t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]){const i=Q(e);return new File([i],"")}else return new File([e],"")},v=async(t,e,n,i)=>{const a=t.get(n),o=await ct(e,a);let s="";const r=t.getAll(i);if(r.length==1)s=await ut(r[0]);else if(r.length>1){const l=r.map(f=>f.text()),c=await Promise.all(l);s=j(c.reduce((f,p)=>`${f}

${p}`))}return s.length>0?s:o},N=(t,e,n,i)=>{const a=t.get(n),o=pt(e,a),r=t.getAll(i).filter(l=>l.size>0);return r.length>0?r:o.size>0?[o]:[]},z=(t,e)=>e?t.startsWith("Cg0NC"):t[0]==10&&t[1]==13&&t[2]==13&&t[3]==10,ft=async t=>{const n=await t.slice(0,4).arrayBuffer();return new Uint8Array(n)},dt=async t=>{const e=new FormData(t),n=e.get("0-type"),i=e.get("0-description"),a=await v(e,n,"0-inputText","0-inputFile");let o=null,s=null;n=="H"&&(o=await v(e,n,"0-inputENDCText","0-inputENDCFile"),s=await v(e,n,"0-inputNRText","0-inputNRFile"));const r={type:n,input:a,inputENDC:o,inputNR:s,multiple0xB826:!0,description:i};return(await B.post(L.PARSE,r)).data},mt=async(t,e)=>{const n=new FormData(t),i=[];for(let s=0;s<e;s++){const r=n.get(`${s}-type`),l=n.get(`${s}-description`),c=await v(n,r,`${s}-inputText`,`${s}-inputFile`);if(r=="P"&&z(c,!0))throw K;let f=[c],p=[];if(r=="H"){const g=await v(n,r,`${s}-inputENDCText`,`${s}-inputENDCFile`),b=await v(n,r,`${s}-inputNRText`,`${s}-inputNRFile`);f=[c,g,b],p=["LTE","ENDC","NR"]}const _={type:r,inputs:f,subTypes:p,description:l};i.push(_)}const o=(await B.post(L.PARSEMULTI,i)).data;if(o.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return o},xt=async(t,e)=>{const n=new FormData(t),i=[],a=[];for(let l=0;l<e;l++){const c=n.get(`${l}-type`),f=n.get(`${l}-description`),p=N(n,c,`${l}-inputText`,`${l}-inputFile`);let _=[...p];if(c=="P"){const x=_[0];if(x!=null){const Y=await ft(x);if(z(Y,!1))throw K}}let g=null,b=null;c=="H"&&(g=N(n,c,`${l}-inputENDCText`,`${l}-inputENDCFile`)[0],b=N(n,c,`${l}-inputNRText`,`${l}-inputNRFile`)[0],_=[...p,g,b]);const F=[],$=[];let U=a.length;_.forEach(x=>{x!=null&&(c=="H"&&(x==g?F.push("ENDC"):x==b?F.push("NR"):F.push("LTE")),a.push(x),$.push(U),U++)}),i.push({type:c,inputIndexes:$,subTypes:F,description:f})}const o=L.PARSEMULTIPART,r=(await B.postForm(o,{requests:JSON.stringify(i),file:a})).data;if(r.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return r},yt=async(t,e)=>{const[n,i,a,o,s]=P();a.value=void 0,s.value=!0;try{let r,l,c,f;if(i.value){l="/view/multi/?id=";let p;await q.isMultiPartSupported()?p=await xt(e,n.value):p=await mt(e,n.value),c=p.id,r=p.capabilitiesList??[],f=p.description}else{l="/view/?id=";const p=await dt(e);c=p.id,r=[p]}c!=null&&(history.pushState({},"",l+c),window.addEventListener("popstate",()=>{a.value=void 0,o.value=void 0,s.value=!1},{once:!0})),s.value=!1,a.value=r,o.value=f}catch(r){throw s.value=!1,new tt(r)}},ht=()=>{const[t]=P();t.value>1&&t.value--},vt=async()=>{const[t]=P();t.value=await q.isMultiSupported()},_t=()=>{const[t]=P();t.value++},gt=G(E(()=>D(()=>import("./q-7-UgCeLL.js"),__vite__mapDeps([])),"s_RxJnt3K50Co")),bt=()=>{J();const t=w(void 0),e=w(void 0),n=w(!1),i=w(1),a=w(!1),o=E(()=>D(()=>Promise.resolve().then(()=>A),void 0),"s_XNkxOB2umQE",[i,a,t,e,n]);return X(E(()=>D(()=>Promise.resolve().then(()=>A),void 0),"s_Rsa6BhqxF4U",[a]),{strategy:"document-ready"}),d(I,{children:[h("div",null,{class:y((s,r)=>r.value||s.value!==void 0?"hidden":"",[t,n])},[d(M,{addClasses:"mb-4",text:"Parser",[u]:{addClasses:u,text:u}},3,"aW_0"),h("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},h("form",null,{autocomplete:"off",class:"m-auto w-full max-w-2xl",onSubmit$:o,"preventdefault:submit":!0},[[...Array(i.value).keys()].map(s=>d(gt,{prefix:`${s}-`,submitting:n,get multiparse(){return a.value},[u]:{multiparse:y(r=>r.value,[a]),submitting:u}},3,s)),h("div",null,{class:"flex flex-wrap gap-x-4"},[d(C,{label:"Remove",type:"button",get hidden(){return!a.value||i.value<2},onClick$:E(()=>D(()=>Promise.resolve().then(()=>A),void 0),"s_PZjg2AEq0h0",[i]),[u]:{hidden:y((s,r)=>!r.value||s.value<2,[i,a]),label:u,onClick$:u,type:u}},3,"aW_1"),d(C,{label:"Add",type:"button",get hidden(){return!a.value},onClick$:E(()=>D(()=>Promise.resolve().then(()=>A),void 0),"s_iTi9KwAcEYg",[i]),[u]:{hidden:y(s=>!s.value,[a]),label:u,onClick$:u,type:u}},3,"aW_2"),h("div",null,{class:y(s=>s.value>1&&"min-w-full"||"flex-1",[i])},d(C,{label:"Submit",type:"submit",[u]:{label:u,type:u}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),t.value==null&&n.value&&h("div",null,{class:"flex flex-1 flex-col"},d(et,{centered:!0,[u]:{centered:u}},3,"aW_4"),1,"aW_5"),t.value!==void 0&&!n.value&&d(I,{children:[d(M,{text:"View",[u]:{text:u}},3,"aW_6"),d(nt,{get capabilitiesList(){return t.value},get groupDescription(){return e.value},[u]:{capabilitiesList:y(s=>s.value,[t]),groupDescription:y(s=>s.value,[e])}},3,"aW_7")]},1,"aW_8")]},1,"aW_9")},A=Object.freeze(Object.defineProperty({__proto__:null,_hW:Z,s_PZjg2AEq0h0:ht,s_Rsa6BhqxF4U:vt,s_XNkxOB2umQE:yt,s_iTi9KwAcEYg:_t,s_wW02utqxH8E:bt},Symbol.toStringTag,{value:"Module"}));export{Z as _hW,ht as s_PZjg2AEq0h0,vt as s_Rsa6BhqxF4U,yt as s_XNkxOB2umQE,_t as s_iTi9KwAcEYg,bt as s_wW02utqxH8E};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}