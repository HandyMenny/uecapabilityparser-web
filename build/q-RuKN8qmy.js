import{u as T,G as Z,y as _,_ as m,g as K,Z as A,n as Y,M as d,d as b,Y as s,q as h,A as k,p as X}from"./q-OyUNoDim.js";import{E as M,a as q}from"./q-s5IYQJWZ.js";import{S as J}from"./q-x9OmfOo3.js";import{B as W}from"./q-R2-L3Y_F.js";import{C as ee}from"./q-bMS8yB9f.js";import{M as te}from"./q-GDSEpYq3.js";import{T as V}from"./q-uHTLEijd.js";const ne=typeof btoa=="function",I=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const H=typeof TextEncoder=="function"?new TextEncoder:void 0,ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",w=Array.prototype.slice.call(ae);(e=>{let t={};return e.forEach((r,a)=>t[r]=a),t})(w);const f=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const G=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),se=e=>{let t,r,a,o,c="";const p=e.length%3;for(let l=0;l<e.length;){if((r=e.charCodeAt(l++))>255||(a=e.charCodeAt(l++))>255||(o=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");t=r<<16|a<<8|o,c+=w[t>>18&63]+w[t>>12&63]+w[t>>6&63]+w[t&63]}return p?c.slice(0,p-3)+"===".substring(p):c},j=ne?e=>btoa(e):I?e=>Buffer.from(e,"binary").toString("base64"):se,U=I?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let a=0,o=e.length;a<o;a+=4096)r.push(f.apply(null,e.subarray(a,a+4096)));return j(r.join(""))},z=(e,t=!1)=>t?G(U(e)):U(e),re=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?f(192|t>>>6)+f(128|t&63):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|t&63)}},oe=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ie=e=>e.replace(oe,re),Q=I?e=>Buffer.from(e,"utf8").toString("base64"):H?e=>U(H.encode(e)):e=>j(ie(e)),B=(e,t=!1)=>t?G(Q(e)):Q(e),le=async(e,t)=>{const[r,a,o,c,p,l,F]=T();c.value=void 0,l.value=!0;try{const n=new FormData(t),v=r.value,P=[];for(let i=0;i<v;i++){const u=n.get(`${i}-type`),x=await F(u,n.get(`${i}-inputText`)),D=n.getAll(`${i}-inputFile`);let C="";if(D.length>1){const N=await Promise.all(D.map(async y=>await y.text()));C=B(N.reduce((y,L)=>y+`

`+L))}else D.length!=0&&(C=await a(D[0]));const E=C.length>0?C:x;if(u=="P"&&E.startsWith("Cg0NC")&&E[5]>"f"&&E[5]<"w")throw"PcapNg isn't supported, please convert this file to PCAP before submitting.";let S="",R="";if(u=="H"){const N=B(n.get(`${i}-inputENDCText`)),y=await a(n.get(`${i}-inputENDCFile`));S=y.length>0?y:N;const L=B(n.get(`${i}-inputNRText`)),O=await a(n.get(`${i}-inputNRFile`));R=O.length>0?O:L}const $=n.get(`${i}-description`);o?P.push({type:u,inputs:[E,S,R],subTypes:["LTE","ENDC","NR"],description:$}):P.push({type:u,input:E,inputENDC:S,inputNR:R,multiple0xB826:!0,description:$})}if(o){const i=M.PARSEMULTI,u=await q.post(i,P),x=u.data;if(x.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";history.pushState({},"","/view/multi/?id="+u.data.id),window.addEventListener("popstate",()=>{c.value=void 0,p.value=void 0,l.value=!1},{once:!0}),l.value=!1,c.value=x.capabilitiesList,p.value=x.description}else{const i=M.PARSE,u=await q.post(i,P[0]);history.pushState({},"","/view/?id="+u.data.id),window.addEventListener("popstate",()=>{c.value=void 0,p.value=void 0,l.value=!1},{once:!0});const x=u.data;l.value=!1,c.value=[x],p.value=void 0}}catch(n){console.error(n),l.value=!1,alert(n)}},ue=async e=>{const t=await e.arrayBuffer();return z(new Uint8Array(t))},ce=()=>{const[e]=T();e.value>1&&e.value--},de=async(e,t)=>{const[r]=T();return e=="E"||e=="SHNR"||e=="P"||e=="DLF"||e=="QMDL"||e=="HDF"||e=="SDM"?z(await r(t)):B(t)},fe=e=>{var a;const r=(a=e.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:a.map(o=>parseInt(o,16));return Uint8Array.from(r??[])},pe=async()=>{const[e]=T();e.value=await J.isMultiSupported()},_e=()=>{const[e]=T();e.value++},me=Z(_(()=>m(()=>import("./q-c4i_b6D5.js"),__vite__mapDeps([])),"s_RxJnt3K50Co")),ve=()=>{K();const e=A(void 0),t=A(void 0),r=A(!1),a=A(1),o=A(!1),F=_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_XNkxOB2umQE",[a,_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_FPWv3lWNHQg"),o,e,t,r,_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_GMaQow7nNzE",[_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_Iqiy8FRI5Ek")])]);return Y(_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_Rsa6BhqxF4U",[o]),{strategy:"document-ready"}),d(k,{children:[b("div",null,{class:h((n,v)=>v.value||n.value!==void 0?"hidden":"",[e,r])},[d(V,{addClasses:"mb-4",text:"Parser",[s]:{addClasses:s,text:s}},3,"aW_0"),b("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},b("form",null,{autocomplete:"off",class:"m-auto w-full max-w-2xl",onSubmit$:F,"preventdefault:submit":!0},[[...Array(a.value).keys()].map(n=>d(me,{prefix:`${n}-`,submitting:r,get multiparse(){return o.value},[s]:{multiparse:h(v=>v.value,[o]),submitting:s}},3,n)),b("div",null,{class:"flex flex-wrap gap-x-4"},[d(W,{label:"Remove",type:"button",get hidden(){return!o.value||a.value<2},onClick$:_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_PZjg2AEq0h0",[a]),[s]:{hidden:h((n,v)=>!v.value||n.value<2,[a,o]),label:s,onClick$:s,type:s}},3,"aW_1"),d(W,{label:"Add",type:"button",get hidden(){return!o.value},onClick$:_(()=>m(()=>Promise.resolve().then(()=>g),void 0),"s_iTi9KwAcEYg",[a]),[s]:{hidden:h(n=>!n.value,[o]),label:s,onClick$:s,type:s}},3,"aW_2"),b("div",null,{class:h(n=>n.value>1&&"min-w-full"||"flex-1",[a])},d(W,{label:"Submit",type:"submit",[s]:{label:s,type:s}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),e.value==null&&r.value&&b("div",null,{class:"flex flex-1 flex-col"},d(ee,{centered:!0,[s]:{centered:s}},3,"aW_4"),1,"aW_5"),e.value!==void 0&&!r.value&&d(k,{children:[d(V,{text:"View",[s]:{text:s}},3,"aW_6"),d(te,{get capabilitiesList(){return e.value},get groupDescription(){return t.value},[s]:{capabilitiesList:h(n=>n.value,[e]),groupDescription:h(n=>n.value,[t])}},3,"aW_7")]},1,"aW_8")]},1,"aW_9")},g=Object.freeze(Object.defineProperty({__proto__:null,_hW:X,s_FPWv3lWNHQg:ue,s_GMaQow7nNzE:de,s_Iqiy8FRI5Ek:fe,s_PZjg2AEq0h0:ce,s_Rsa6BhqxF4U:pe,s_XNkxOB2umQE:le,s_iTi9KwAcEYg:_e,s_wW02utqxH8E:ve},Symbol.toStringTag,{value:"Module"}));export{X as _hW,ue as s_FPWv3lWNHQg,de as s_GMaQow7nNzE,fe as s_Iqiy8FRI5Ek,ce as s_PZjg2AEq0h0,pe as s_Rsa6BhqxF4U,le as s_XNkxOB2umQE,_e as s_iTi9KwAcEYg,ve as s_wW02utqxH8E};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}