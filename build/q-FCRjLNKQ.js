import{u as F,G as z,y as g,_ as b,g as K,Z as _,n as J,M as d,d as v,Y as c,q as x,A as I,p as X}from"./q-OyUNoDim.js";import{S as q}from"./q-x8gzk8Gq.js";import{a as B,E as R}from"./q-ZppFbWGL.js";import{m as tt}from"./q-a7kE2C9z.js";import{A as et}from"./q-ZkmWegOP.js";import{B as C}from"./q-R2-L3Y_F.js";import{C as nt}from"./q-bMS8yB9f.js";import{M as st}from"./q-vXgepSV-.js";import{T as U}from"./q-uHTLEijd.js";const it=typeof btoa=="function",L=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;const W=typeof TextEncoder=="function"?new TextEncoder:void 0,rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=Array.prototype.slice.call(rt);(t=>{let e={};return t.forEach((n,s)=>e[n]=s),e})(T);const y=String.fromCharCode.bind(String);typeof Uint8Array.from=="function"&&Uint8Array.from.bind(Uint8Array);const O=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),at=t=>{let e,n,s,o,u="";const r=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|s<<8|o,u+=T[e>>18&63]+T[e>>12&63]+T[e>>6&63]+T[e&63]}return r?u.slice(0,r-3)+"===".substring(r):u},k=it?t=>btoa(t):L?t=>Buffer.from(t,"binary").toString("base64"):at,S=L?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let s=0,o=t.length;s<o;s+=4096)n.push(y.apply(null,t.subarray(s,s+4096)));return k(n.join(""))},V=(t,e=!1)=>e?O(S(t)):S(t),ot=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?y(192|e>>>6)+y(128|e&63):y(224|e>>>12&15)+y(128|e>>>6&63)+y(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return y(240|e>>>18&7)+y(128|e>>>12&63)+y(128|e>>>6&63)+y(128|e&63)}},lt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ut=t=>t.replace(lt,ot),H=L?t=>Buffer.from(t,"utf8").toString("base64"):W?t=>S(W.encode(t)):t=>k(ut(t)),j=(t,e=!1)=>e?O(H(t)):H(t),G="PcapNg isn't supported, please convert this file to PCAP before submitting.<br>You can use [prepocessor](https://github.com/HandyMenny/uecapabilityparser-prepocessor) to do that.",ct=async t=>{const e=await t.arrayBuffer();return V(new Uint8Array(e))},Q=t=>{var s;const n=(s=t.replace(/\s|0x|,|;/g,"").toUpperCase().match(/[0-9A-Fa-f]{1,2}/g))==null?void 0:s.map(o=>parseInt(o,16));return Uint8Array.from(n??[])},pt=async(t,e)=>t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]?V(Q(e)):j(e),ft=(t,e)=>{if(t in["E","SHNR","P","DLF","QMDL","HDF","SDM"]){const s=Q(e);return new File([s],"")}else return new File([e],"")},w=async(t,e,n,s)=>{const o=t.get(n),u=await pt(e,o);let r="";const a=t.getAll(s);if(a.length==1)r=await ct(a[0]);else if(a.length>1){const l=a.map(p=>p.text()),i=await Promise.all(l);r=j(i.reduce((p,m)=>`${p}

${m}`))}return r.length>0?r:u},N=(t,e,n,s)=>{const o=t.get(n),u=ft(e,o),a=t.getAll(s).filter(l=>l.size>0);return a.length>0?a:u.size>0?[u]:[]},Y=(t,e)=>e?t.startsWith("Cg0NC"):t[0]==10&&t[1]==13&&t[2]==13&&t[3]==10,dt=async t=>{const n=await t.slice(0,4).arrayBuffer();return new Uint8Array(n)},mt=async t=>{const e=new FormData(t),n=e.get("0-type"),s=e.get("0-description"),o=await w(e,n,"0-inputText","0-inputFile");let u=null,r=null;n=="H"&&(u=await w(e,n,"0-inputENDCText","0-inputENDCFile"),r=await w(e,n,"0-inputNRText","0-inputNRFile"));const a={type:n,input:o,inputENDC:u,inputNR:r,multiple0xB826:!0,description:s};return(await B.post(R.PARSE,a)).data},yt=async(t,e)=>{const n=new FormData(t),s=[];for(let r=0;r<e;r++){const a=n.get(`${r}-type`),l=n.get(`${r}-description`),i=await w(n,a,`${r}-inputText`,`${r}-inputFile`);if(a=="P"&&Y(i,!0))throw G;let p=[i],m=[];if(a=="H"){const E=await w(n,a,`${r}-inputENDCText`,`${r}-inputENDCFile`),A=await w(n,a,`${r}-inputNRText`,`${r}-inputNRFile`);p=[i,E,A],m=["LTE","ENDC","NR"]}const f={type:a,inputs:p,subTypes:m,description:l};s.push(f)}const u=(await B.post(R.PARSEMULTI,s)).data;if(u.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return u},xt=async(t,e)=>{const n=new FormData(t),s=[],o=[];for(let l=0;l<e;l++){const i=n.get(`${l}-type`),p=n.get(`${l}-description`),m=N(n,i,`${l}-inputText`,`${l}-inputFile`);let f=[...m];if(i=="P"){const h=f[0];if(h!=null){const Z=await dt(h);if(Y(Z,!1))throw G}}let E=null,A=null;i=="H"&&(E=N(n,i,`${l}-inputENDCText`,`${l}-inputENDCFile`)[0],A=N(n,i,`${l}-inputNRText`,`${l}-inputNRFile`)[0],f=[...m,E,A]);const P=[],$=[];let M=o.length;f.forEach(h=>{h!=null&&(i=="H"&&(h==E?P.push("ENDC"):h==A?P.push("NR"):P.push("LTE")),o.push(h),$.push(M),M++)}),s.push({type:i,inputIndexes:$,subTypes:P,description:p})}const u=R.PARSEMULTIPART,a=(await B.postForm(u,{requests:JSON.stringify(s),file:o})).data;if(a.capabilitiesList==null)throw"Parsing failed. The input is invalid or doesn't contain valid data.";return a},ht=async(t,e)=>{const[n,s,o,u,r,a]=F();u.value=void 0,a.value=!0;try{let l,i,p,m;if(o.value){i="/view/multi/?id=";let f;await q.isMultiPartSupported()?f=await xt(e,s.value):f=await yt(e,s.value),p=f.id,l=f.capabilitiesList??[],m=f.description}else{i="/view/?id=";const f=await mt(e);p=f.id,l=[f]}p!=null&&(history.pushState({},"",i+p),window.addEventListener("popstate",()=>{u.value=void 0,r.value=void 0,a.value=!1},{once:!0})),a.value=!1,u.value=l,r.value=m}catch(l){console.error(l),a.value=!1,n(l)}},_t=()=>{const[t]=F();t.value>1&&t.value--},vt=t=>{const[e,n]=F();e.value=tt(t),n.value=!0},gt=async()=>{const[t]=F();t.value=await q.isMultiSupported()},bt=()=>{const[t]=F();t.value++},wt=z(g(()=>b(()=>import("./q-n4EhH316.js"),__vite__mapDeps([])),"s_RxJnt3K50Co")),Et=()=>{K();const t=_(void 0),e=_(void 0),n=_(!1),s=_(1),o=_(!1),u=_(!1),r=_(),l=g(()=>b(()=>Promise.resolve().then(()=>D),void 0),"s_XNkxOB2umQE",[g(()=>b(()=>Promise.resolve().then(()=>D),void 0),"s_mBNsaSlbySI",[r,u]),s,o,t,e,n]);return J(g(()=>b(()=>Promise.resolve().then(()=>D),void 0),"s_Rsa6BhqxF4U",[o]),{strategy:"document-ready"}),d(I,{children:[v("div",null,{class:x((i,p)=>p.value||i.value!==void 0?"hidden":"",[t,n])},[d(U,{addClasses:"mb-4",text:"Parser",[c]:{addClasses:c,text:c}},3,"aW_0"),v("div",null,{class:"my-[-1rem] flex flex-1 flex-col"},v("form",null,{autocomplete:"off",class:"m-auto w-full max-w-2xl",onSubmit$:l,"preventdefault:submit":!0},[[...Array(s.value).keys()].map(i=>d(wt,{prefix:`${i}-`,submitting:n,get multiparse(){return o.value},[c]:{multiparse:x(p=>p.value,[o]),submitting:c}},3,i)),v("div",null,{class:"flex flex-wrap gap-x-4"},[d(C,{label:"Remove",type:"button",get hidden(){return!o.value||s.value<2},onClick$:g(()=>b(()=>Promise.resolve().then(()=>D),void 0),"s_PZjg2AEq0h0",[s]),[c]:{hidden:x((i,p)=>!p.value||i.value<2,[s,o]),label:c,onClick$:c,type:c}},3,"aW_1"),d(C,{label:"Add",type:"button",get hidden(){return!o.value},onClick$:g(()=>b(()=>Promise.resolve().then(()=>D),void 0),"s_iTi9KwAcEYg",[s]),[c]:{hidden:x(i=>!i.value,[o]),label:c,onClick$:c,type:c}},3,"aW_2"),v("div",null,{class:x(i=>i.value>1&&"min-w-full"||"flex-1",[s])},d(C,{label:"Submit",type:"submit",[c]:{label:c,type:c}},3,"aW_3"),1,null)],1,null)],1,null),1,null)],1,null),u&&d(et,{children:x(i=>i.value,[r]),show:u,title:"Error",[c]:{show:c,title:c}},3,"aW_4"),t.value==null&&n.value&&v("div",null,{class:"flex flex-1 flex-col"},d(nt,{centered:!0,[c]:{centered:c}},3,"aW_5"),1,"aW_6"),t.value!==void 0&&!n.value&&d(I,{children:[d(U,{text:"View",[c]:{text:c}},3,"aW_7"),d(st,{get capabilitiesList(){return t.value},get groupDescription(){return e.value},[c]:{capabilitiesList:x(i=>i.value,[t]),groupDescription:x(i=>i.value,[e])}},3,"aW_8")]},1,"aW_9")]},1,"aW_10")},D=Object.freeze(Object.defineProperty({__proto__:null,_hW:X,s_PZjg2AEq0h0:_t,s_Rsa6BhqxF4U:gt,s_XNkxOB2umQE:ht,s_iTi9KwAcEYg:bt,s_mBNsaSlbySI:vt,s_wW02utqxH8E:Et},Symbol.toStringTag,{value:"Module"}));export{X as _hW,_t as s_PZjg2AEq0h0,gt as s_Rsa6BhqxF4U,ht as s_XNkxOB2umQE,bt as s_iTi9KwAcEYg,vt as s_mBNsaSlbySI,Et as s_wW02utqxH8E};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}